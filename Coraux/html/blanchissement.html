<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blanchissement des Coraux</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <header id="main-header">
        <img src="../img/logo.png" alt="Logo du site" class="logo">
        <h1>Les Coraux</h1>
        <nav>
            <ul class="header-links">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="biodiversite.html">Biodiversité</a></li>
                <li><a href="blanchissement.html">Blanchissement</a></li>
                <li><a href="menaces.html">Menaces & Protection</a></li>
                <li><a href="a-propos.html">À propos</a></li>
            </ul>
        </nav>
    </header>

    <nav id="sticky-navbar" class="sticky-navbar">
        <img src="../img/logo.png" alt="Logo" class="sticky-logo">
                <h4>Les Coraux</h4> 
                <a href="index.html">Accueil</a>
                <a href="biodiversite.html">Biodiversité</a>
                <a href="blanchissement.html">Blanchissement</a>
                <a href="menaces.html">Menaces & Protection</a>
                <a href="a-propos.html">À propos</a>
                
    </nav>

    <main>
        <h2>Le blanchissement des coraux</h2>
        <p>Le blanchissement des coraux est un phénomène inquiétant causé par le réchauffement des océans et d'autres stress environnementaux. Il peut mener à la mort des récifs coralliens.</p>
        <img src="images/blanchissement.jpg" alt="Corail blanchi">
        <p>Le blanchissement se produit lorsque les coraux expulsent les algues symbiotiques (zooxanthelles) qui leur donnent leur couleur. Cela peut être causé par :</p>
        <ul>
            <li>Augmentation de la température de l'eau</li>
            <li>Acidification des océans</li>
            <li>Pollution</li>
            <li>Problèmes de salinité</li>
            <li>Maladies</li>
        </ul>
        <p>Les coraux blanchis deviennent vulnérables aux maladies et peuvent mourir si les conditions ne s'améliorent pas rapidement.</p>
        <h3>Graphique de la population d'Acropora palmata</h3>
        <p>Voici un graphique représentant l'évolution de la population d'Acropora palmata, une espèce de corail menacée, dans les Caraïbes entre 1970 et 2020.</p>
            <canvas id="monGraphe" width="450" height="250" style="display:block; margin:auto; max-width:100%;"></canvas>
        <p>Les données proviennent de <a href="https://ourworldindata.org/grapher/caribbean-acropora">Our World in Data</a>.</p>
    </main>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
        <script>
        Papa.parse('https://ourworldindata.org/grapher/caribbean-acropora.csv?v=1&csvType=filtered&useColumnShortNames=true', {
            download: true,
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
                // Affiche les premières lignes pour vérifier les clés
                console.log('Première ligne CSV:', results.data[0]);
                // Cherche la bonne clé pour la colonne de données
                const firstRow = results.data[0];
                const keys = Object.keys(firstRow);
                // Affiche toutes les clés pour vérifier le nom exact
                console.log('Clés trouvées:', keys);

                // Utilise la clé exacte trouvée (ici "Acropora palmata")
                const valueKey = keys.find(k => k.toLowerCase().includes('acropora'));
                if (!valueKey) {
                    alert("Colonne de données non trouvée !");
                    return;
                }

                // Filtrer les lignes valides et numériques
                const filtered = results.data.filter(row => 
                    row.Year && 
                    row[valueKey] && 
                    !isNaN(Number(row[valueKey]))
                );
                const labels = filtered.map(row => row.Year);
                const data = filtered.map(row => Number(row[valueKey]));
                console.log('labels:', labels);
                console.log('data:', data);

                if (data.length === 0) {
                    alert("Aucune donnée valide à afficher !");
                    return;
                }

                new Chart(document.getElementById('monGraphe').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: valueKey,
                            data: data,
                            borderColor: 'rgba(0,123,255,1)',
                            backgroundColor: 'rgba(0,123,255,0.1)',
                            fill: true
                        }]
                    }
                });
            }
        });
        </script>


    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-main">
                <div class="footer-brand">
                    <img src="../img/logo.png" alt="Logo du site" class="footer-logo">
                    <h3>Les Coraux</h3>
                    <p>Engagés pour la préservation des récifs coralliens et la sensibilisation au blanchissement des coraux.</p>
                </div>
                <div class="footer-links">
                    <h4>Navigation</h4>
                    <ul>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="blanchissement.html">Blanchissement</a></li>
                        <li><a href="a-propos.html">À propos</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Ressources</h4>
                    <ul>
                        <li><a href="#">Articles scientifiques</a></li>
                        <li><a href="#">Guides pédagogiques</a></li>
                        <li><a href="#">Actions locales</a></li>
                        <li><a href="#">Faire un don</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Les Coraux. Tous droits réservés.</p>
                <p>Photos : Unsplash & Pexels</p>
            </div>
        </div>
    </footer>
    <script src="../js/script.js"></script>
</body>
</html>
